version: '3.8'

services:
  vrising:
    build: .
    container_name: vrising-arm64
    restart: unless-stopped
    
    # Recursos - ajuste conforme sua VM
    deploy:
      resources:
        limits:
          cpus: '3.5'
          memory: 20G
        reservations:
          memory: 16G
    
    # Portas UDP
    ports:
      - "27015:27015/udp"
      - "27016:27016/udp"
    
    # Volumes persistentes
    volumes:
      - vrising-data:/data
      - vrising-steam:/steam
    
    # Configuração do servidor
    environment:
      - VR_SERVER_NAME=VRising-FEX-ARM64
      - VR_SAVE_NAME=world1
      - VR_GAME_PORT=27015
      - VR_QUERY_PORT=27016
      - FORCE_UPDATE=false
    
    # Healthcheck básico
    healthcheck:
      test: ["CMD", "pgrep", "-f", "VRisingServer"]
      interval: 60s
      timeout: 10s
      retries: 3
      start_period: 300s

volumes:
  vrising-data:
  vrising-steam:
